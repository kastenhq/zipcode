language: go

go:
  - 1.11

env:
  - GO111MODULE=on

vote:
  on_success:
    Verified: 1
    Code-Review: 2
  on_failure:
    Verified: -1
    Code-Review: -2

build:

  pre_ci:
    - kubectl create namespace "${BRANCH}-${BUILD_NUMBER}"

  pre_ci_boot:
    options: " -t -v ${SHIPPABLE_BUILD_DIR} --expose=9000-9030 -v /var/run/docker.sock:/var/run/docker.sock"

  ci:
    - go build ./..

  on_success:
    - kubectl delete namespace "${BRANCH}-${BUILD_NUMBER}"
    - shipctl post_resource_state "zipcode-img" "versionName" "${BRANCH}.${BUILD_NUMBER}"



integrations:
  hub:
    - integrationName: dockerhub-kastenio
      type: dockerRegistryLogin
